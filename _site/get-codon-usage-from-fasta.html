<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Get codon usage from FASTA</title>
  <meta name="description" content="">
  <link rel="canonical" href="http://localhost:4000/get-codon-usage-from-fasta">
  <link rel="alternate" type="application/rss+xml" title="Martin Fung&#39;s Page Feed"
    href="http://localhost:4000/feed.xml">
  
  <link rel="shortcut icon" href="/favicon.png" type="image/png" />
  
  <!-- Styles -->
  <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%7CNoto+Serif:400,400i,700,700i&display=swap" rel="stylesheet">
  <link href="/assets/css/style.css" rel="stylesheet">
</head>

<body>

  <div id="page" class="site">
    <div class="inner">
      <h1 style="text-align: center; padding: 1em 0 0.3em">Martin Fung's Page
</h1>

<h2 style="text-align: center; margin: 0">
    <span>| <a href="/">Home</a></span>
    
    
    
    <span>|</span>
    <a class="" href="/tags/">Blog</a>
    
    
    
    <span>|</span>
    <a class="" href="/cv">CV</a>
    
    <span>|</span>
</h2>
<hr>

      <main class="main-content fadeInDown delay_075s">

  <article class="post">
    <header class="post-header">
      <time class="post-date" datetime="2021-06-22">June 22, 2021 / Tuesday</time>
      <h1 class="post-title">Get codon usage from FASTA</h1>
      <div class="post-meta">
        <span class="post-tags">Tags: <a href="/tags/#python-script" rel="tag">python-script</a></span>
      </div><!-- .post-meta -->
      
    </header><!-- .post-header -->
    <div class="post-content">
      <ul>
  <li>Build-in codon usage utility from Biopython gives an unsorted list of all codons</li>
  <li>This script prints out a codon usage list sorted by amino acids</li>
</ul>

<!--more-->

<h2 id="input-ibvfasta">(input) IBV.fasta</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;IBV-ORF1ab
ATGGCTTCAAGCCTAAAACAGGGAGTATCTCCCAAACCACGGGATGTCATTCTT...TAG
&gt;IBV-S
ATGTTGGTAACACCTCTTTTACTAGTGACTCTTTTGTGTGCACTATGTAGTGCT...TGA
&gt;IBV-E
ATGAATTTATTGAATAAGTCGCTAGAGGAGAATGGAAGTTTTCTAACAGCGCTT...TGA
&gt;IBV-M
ATGCCCAACGAGACAAATTGTACTCTTGACTTTGAACAGTCAGTTCAGCTTTTT...TAA
&gt;IBV-N
ATGGCAAGCGGTAAAGCAGCTGGAAAAACAGACGCCCCAGCGCCAGTCATTAAA...TGA
</code></pre></div></div>

<h2 id="built-in-codon-usage-method-in-biopython">Built-in codon usage method in Biopython</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">Seq</span>
<span class="kn">from</span> <span class="nn">Bio.SeqUtils</span> <span class="kn">import</span> <span class="n">CodonUsage</span>

<span class="n">CAI</span> <span class="o">=</span> <span class="n">CodonUsage</span><span class="p">.</span><span class="n">CodonAdaptationIndex</span><span class="p">()</span>
<span class="n">CAI</span><span class="p">.</span><span class="n">generate_index</span><span class="p">(</span><span class="s">"IBV.fasta"</span><span class="p">)</span>
<span class="n">CAI</span><span class="p">.</span><span class="n">print_index</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AAA	1.000
AAC	0.317
AAG	0.982
AAT	1.000
ACA	0.843
ACC	0.166
ACG	0.149
ACT	1.000
AGA	1.000
AGC	0.207
AGG	0.436
AGT	0.838
ATA	0.742
ATC	0.167
ATG	1.000
ATT	1.000
CAA	1.000
CAC	0.447
CAG	0.644
CAT	1.000
CCA	0.985
CCC	0.219
CCG	0.204
CCT	1.000
CGA	0.168
CGC	0.386
CGG	0.099
CGT	0.832
CTA	0.356
CTC	0.201
CTG	0.251
CTT	1.000
GAA	1.000
GAC	0.420
GAG	0.665
GAT	1.000
GCA	0.824
GCC	0.202
GCG	0.160
GCT	1.000
GGA	0.339
GGC	0.248
GGG	0.078
GGT	1.000
GTA	0.437
GTC	0.218
GTG	0.350
GTT	1.000
TAA	0.333
TAC	0.370
TAG	0.333
TAT	1.000
TCA	0.606
TCC	0.096
TCG	0.141
TCT	1.000
TGA	1.000
TGC	0.229
TGG	1.000
TGT	1.000
TTA	0.726
TTC	0.269
TTG	0.758
TTT	1.000
</code></pre></div></div>

<h2 id="my-script">My script</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">Seq</span>
<span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqIO</span>

<span class="c1">### take amino acid single letter as argument
### return a list of codons
### for example, take "*"
### return ["TGA", "TAG", "TAA"]
</span><span class="k">def</span> <span class="nf">from_aa_get_codon_list</span><span class="p">(</span><span class="n">aa</span><span class="p">):</span>
    <span class="n">codon_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">genetic_table_dic</span> <span class="o">=</span> <span class="p">{</span>\
    <span class="s">'ATA'</span><span class="p">:</span><span class="s">'I'</span><span class="p">,</span> <span class="s">'ATC'</span><span class="p">:</span><span class="s">'I'</span><span class="p">,</span> <span class="s">'ATT'</span><span class="p">:</span><span class="s">'I'</span><span class="p">,</span> <span class="s">'ATG'</span><span class="p">:</span><span class="s">'M'</span><span class="p">,</span> 
    <span class="s">'ACA'</span><span class="p">:</span><span class="s">'T'</span><span class="p">,</span> <span class="s">'ACC'</span><span class="p">:</span><span class="s">'T'</span><span class="p">,</span> <span class="s">'ACG'</span><span class="p">:</span><span class="s">'T'</span><span class="p">,</span> <span class="s">'ACT'</span><span class="p">:</span><span class="s">'T'</span><span class="p">,</span> 
    <span class="s">'AAC'</span><span class="p">:</span><span class="s">'N'</span><span class="p">,</span> <span class="s">'AAT'</span><span class="p">:</span><span class="s">'N'</span><span class="p">,</span> <span class="s">'AAA'</span><span class="p">:</span><span class="s">'K'</span><span class="p">,</span> <span class="s">'AAG'</span><span class="p">:</span><span class="s">'K'</span><span class="p">,</span> 
    <span class="s">'AGC'</span><span class="p">:</span><span class="s">'S'</span><span class="p">,</span> <span class="s">'AGT'</span><span class="p">:</span><span class="s">'S'</span><span class="p">,</span> <span class="s">'AGA'</span><span class="p">:</span><span class="s">'R'</span><span class="p">,</span> <span class="s">'AGG'</span><span class="p">:</span><span class="s">'R'</span><span class="p">,</span> 
    <span class="s">'CTA'</span><span class="p">:</span><span class="s">'L'</span><span class="p">,</span> <span class="s">'CTC'</span><span class="p">:</span><span class="s">'L'</span><span class="p">,</span> <span class="s">'CTG'</span><span class="p">:</span><span class="s">'L'</span><span class="p">,</span> <span class="s">'CTT'</span><span class="p">:</span><span class="s">'L'</span><span class="p">,</span> 
    <span class="s">'CCA'</span><span class="p">:</span><span class="s">'P'</span><span class="p">,</span> <span class="s">'CCC'</span><span class="p">:</span><span class="s">'P'</span><span class="p">,</span> <span class="s">'CCG'</span><span class="p">:</span><span class="s">'P'</span><span class="p">,</span> <span class="s">'CCT'</span><span class="p">:</span><span class="s">'P'</span><span class="p">,</span> 
    <span class="s">'CAC'</span><span class="p">:</span><span class="s">'H'</span><span class="p">,</span> <span class="s">'CAT'</span><span class="p">:</span><span class="s">'H'</span><span class="p">,</span> <span class="s">'CAA'</span><span class="p">:</span><span class="s">'Q'</span><span class="p">,</span> <span class="s">'CAG'</span><span class="p">:</span><span class="s">'Q'</span><span class="p">,</span> 
    <span class="s">'CGA'</span><span class="p">:</span><span class="s">'R'</span><span class="p">,</span> <span class="s">'CGC'</span><span class="p">:</span><span class="s">'R'</span><span class="p">,</span> <span class="s">'CGG'</span><span class="p">:</span><span class="s">'R'</span><span class="p">,</span> <span class="s">'CGT'</span><span class="p">:</span><span class="s">'R'</span><span class="p">,</span> 
    <span class="s">'GTA'</span><span class="p">:</span><span class="s">'V'</span><span class="p">,</span> <span class="s">'GTC'</span><span class="p">:</span><span class="s">'V'</span><span class="p">,</span> <span class="s">'GTG'</span><span class="p">:</span><span class="s">'V'</span><span class="p">,</span> <span class="s">'GTT'</span><span class="p">:</span><span class="s">'V'</span><span class="p">,</span> 
    <span class="s">'GCA'</span><span class="p">:</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'GCC'</span><span class="p">:</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'GCG'</span><span class="p">:</span><span class="s">'A'</span><span class="p">,</span> <span class="s">'GCT'</span><span class="p">:</span><span class="s">'A'</span><span class="p">,</span> 
    <span class="s">'GAC'</span><span class="p">:</span><span class="s">'D'</span><span class="p">,</span> <span class="s">'GAT'</span><span class="p">:</span><span class="s">'D'</span><span class="p">,</span> <span class="s">'GAA'</span><span class="p">:</span><span class="s">'E'</span><span class="p">,</span> <span class="s">'GAG'</span><span class="p">:</span><span class="s">'E'</span><span class="p">,</span> 
    <span class="s">'GGA'</span><span class="p">:</span><span class="s">'G'</span><span class="p">,</span> <span class="s">'GGC'</span><span class="p">:</span><span class="s">'G'</span><span class="p">,</span> <span class="s">'GGG'</span><span class="p">:</span><span class="s">'G'</span><span class="p">,</span> <span class="s">'GGT'</span><span class="p">:</span><span class="s">'G'</span><span class="p">,</span> 
    <span class="s">'TCA'</span><span class="p">:</span><span class="s">'S'</span><span class="p">,</span> <span class="s">'TCC'</span><span class="p">:</span><span class="s">'S'</span><span class="p">,</span> <span class="s">'TCG'</span><span class="p">:</span><span class="s">'S'</span><span class="p">,</span> <span class="s">'TCT'</span><span class="p">:</span><span class="s">'S'</span><span class="p">,</span> 
    <span class="s">'TTC'</span><span class="p">:</span><span class="s">'F'</span><span class="p">,</span> <span class="s">'TTT'</span><span class="p">:</span><span class="s">'F'</span><span class="p">,</span> <span class="s">'TTA'</span><span class="p">:</span><span class="s">'L'</span><span class="p">,</span> <span class="s">'TTG'</span><span class="p">:</span><span class="s">'L'</span><span class="p">,</span> 
    <span class="s">'TAC'</span><span class="p">:</span><span class="s">'Y'</span><span class="p">,</span> <span class="s">'TAT'</span><span class="p">:</span><span class="s">'Y'</span><span class="p">,</span> <span class="s">'TAA'</span><span class="p">:</span><span class="s">'*'</span><span class="p">,</span> <span class="s">'TAG'</span><span class="p">:</span><span class="s">'*'</span><span class="p">,</span> 
    <span class="s">'TGC'</span><span class="p">:</span><span class="s">'C'</span><span class="p">,</span> <span class="s">'TGT'</span><span class="p">:</span><span class="s">'C'</span><span class="p">,</span> <span class="s">'TGA'</span><span class="p">:</span><span class="s">'*'</span><span class="p">,</span> <span class="s">'TGG'</span><span class="p">:</span><span class="s">'W'</span><span class="p">,}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">genetic_table_dic</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">aa</span><span class="p">:</span>
            <span class="n">codon_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">codon_list</span>
<span class="c1">###
</span>


<span class="c1">### take *.fasta file as input
### return codon count and amino acid count
</span><span class="k">def</span> <span class="nf">codon_aa_count</span><span class="p">(</span><span class="n">fasta_file</span><span class="p">):</span>
    <span class="n">codon_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">aa_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">SeqIO</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fasta_file</span><span class="p">,</span> <span class="s">"fasta"</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">record</span><span class="p">.</span><span class="n">seq</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">codon</span> <span class="o">=</span> <span class="n">record</span><span class="p">.</span><span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
            <span class="n">codon_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">codon</span><span class="p">))</span>
            <span class="n">aa</span> <span class="o">=</span> <span class="n">codon</span><span class="p">.</span><span class="n">translate</span><span class="p">()</span>
            <span class="n">aa_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">aa</span><span class="p">))</span>
    <span class="n">codon_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">codon_list</span><span class="p">)</span>
    <span class="n">aa_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">aa_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">codon_count</span><span class="p">,</span> <span class="n">aa_count</span><span class="p">]</span>
<span class="c1">###
</span>


<span class="c1">### take codon_aa_count as argument
### print codon usage for all amino acids
</span><span class="k">def</span> <span class="nf">print_all_codon_usage</span><span class="p">(</span><span class="n">codon_aa_count</span><span class="p">):</span>
    <span class="n">codon_count</span> <span class="o">=</span> <span class="n">codon_aa_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">aa_count</span> <span class="o">=</span> <span class="n">codon_aa_count</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">aa_count</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">aa</span><span class="si">}</span><span class="s">:"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">"   "</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">codon</span> <span class="ow">in</span> <span class="n">from_aa_get_codon_list</span><span class="p">(</span><span class="n">aa</span><span class="p">):</span>
            <span class="n">codon_usage_f</span> <span class="o">=</span> <span class="n">codon_count</span><span class="p">[</span><span class="n">codon</span><span class="p">]</span><span class="o">/</span><span class="n">aa_count</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span>
            <span class="k">print</span> <span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">codon</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">codon_usage_f</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s"> "</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">"  "</span><span class="p">)</span>
        <span class="k">print</span> <span class="p">()</span>
<span class="c1">###
</span>


<span class="c1">### take an amino acid single letter code, codon_count, aa_count
### return the codon usage for that amino acid
</span><span class="k">def</span> <span class="nf">print_codon_usage_for_aa</span><span class="p">(</span><span class="n">aa</span><span class="p">,</span> <span class="n">codon_aa_count</span><span class="p">):</span>
    <span class="n">codon_count</span> <span class="o">=</span> <span class="n">codon_aa_count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">aa_count</span> <span class="o">=</span> <span class="n">codon_aa_count</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span> <span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">aa</span><span class="si">}</span><span class="s">:"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">"   "</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">codon</span> <span class="ow">in</span> <span class="n">from_aa_get_codon_list</span><span class="p">(</span><span class="n">aa</span><span class="p">):</span>
        <span class="n">codon_usage_f</span> <span class="o">=</span> <span class="n">codon_count</span><span class="p">[</span><span class="n">codon</span><span class="p">]</span><span class="o">/</span><span class="n">aa_count</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span>
        <span class="k">print</span> <span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">codon</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">codon_usage_f</span><span class="p">:.</span><span class="mi">3</span><span class="n">f</span><span class="si">}</span><span class="s"> "</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">"  "</span><span class="p">)</span>
    <span class="k">print</span> <span class="p">()</span>
<span class="c1">###
</span>


<span class="c1">## core script
</span><span class="n">codon_aa_count</span> <span class="o">=</span> <span class="n">codon_aa_count</span><span class="p">(</span><span class="s">"IBV.fasta"</span><span class="p">)</span>

<span class="n">print_codon_usage_for_aa</span><span class="p">(</span><span class="s">"V"</span><span class="p">,</span> <span class="n">codon_aa_count</span><span class="p">)</span>
<span class="n">print_codon_usage_for_aa</span><span class="p">(</span><span class="s">"R"</span><span class="p">,</span> <span class="n">codon_aa_count</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"="</span><span class="o">*</span><span class="mi">75</span><span class="p">)</span>
<span class="n">print_all_codon_usage</span><span class="p">(</span><span class="n">codon_aa_count</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>V:   GTA 0.218   GTC 0.109   GTG 0.175   GTT 0.499   
R:   AGA 0.342   AGG 0.149   CGA 0.058   CGC 0.132   CGG 0.034   CGT 0.285   
===========================================================================
M:   ATG 1.000   
A:   GCA 0.377   GCC 0.092   GCG 0.073   GCT 0.457   
S:   AGC 0.072   AGT 0.290   TCA 0.210   TCC 0.033   TCG 0.049   TCT 0.346   
L:   CTA 0.108   CTC 0.061   CTG 0.076   CTT 0.304   TTA 0.221   TTG 0.230   
K:   AAA 0.505   AAG 0.495   
Q:   CAA 0.608   CAG 0.392   
G:   GGA 0.203   GGC 0.149   GGG 0.047   GGT 0.601   
V:   GTA 0.218   GTC 0.109   GTG 0.175   GTT 0.499   
P:   CCA 0.409   CCC 0.091   CCG 0.085   CCT 0.415   
R:   AGA 0.342   AGG 0.149   CGA 0.058   CGC 0.132   CGG 0.034   CGT 0.285   
D:   GAC 0.296   GAT 0.704   
I:   ATA 0.389   ATC 0.088   ATT 0.524   
E:   GAA 0.601   GAG 0.399   
C:   TGC 0.186   TGT 0.814   
F:   TTC 0.212   TTT 0.788   
Y:   TAC 0.270   TAT 0.730   
T:   ACA 0.391   ACC 0.077   ACG 0.069   ACT 0.464   
H:   CAC 0.309   CAT 0.691   
N:   AAC 0.241   AAT 0.759   
W:   TGG 1.000   
*:   TAA 0.200   TAG 0.200   TGA 0.600   
</code></pre></div></div>


    </div><!-- .post-content -->
    <div style="margin-top: 3em"></div>
    <div class="post-meta">
      <span class="post-tags">Tags: <a href="/tags/#python-script" rel="tag">python-script</a></span>
    </div><!-- .post-meta -->
  </article><!-- .post -->

  <div align="right"><a href="#page">Back to top</a></div>
  <div style="margin-top: 3em"></div>

</main><!-- .main-content -->
      <footer class="site-footer">
  <div class="offsite-links">
    
  </div><!-- .offsite-links -->
  <div class="footer-bottom">
    <div class="site-info">
      <p>Copyright © 2007-21 To Sing Fung<br />Powered by Jekyll. Theme modified from Scriptor</p>

    </div><!-- .site-info -->
  </div><!-- .footer-bottom -->
</footer><!-- .site-footer -->

    </div><!-- .inner -->
  </div><!-- .site -->
  
  <!-- Scripts -->
  <script src="/assets/js/plugins.js"></script>
  <script src="/assets/js/custom.js"></script>

</body>
</html>